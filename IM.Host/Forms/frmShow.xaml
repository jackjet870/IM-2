<Window
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:IM.Host.Forms"
        xmlns:Model="clr-namespace:IM.Model;assembly=IM.Model"
        xmlns:Helpers="clr-namespace:IM.Base.Helpers;assembly=IM.Base"
        xmlns:Classes="clr-namespace:IM.Base.Classes;assembly=IM.Base"
        xmlns:Converters="clr-namespace:IM.Base.Converters;assembly=IM.Base"
        xmlns:styClasses="clr-namespace:IM.Styles.Classes;assembly=IM.Styles"
        xmlns:xctk="http://schemas.xceed.com/wpf/xaml/toolkit"
        x:Class="IM.Host.Forms.frmShow"
        mc:Ignorable="d"
        Title="Show" d:DesignHeight="768" d:DesignWidth="1024" WindowStartupLocation="CenterScreen"  WindowStyle="SingleBorderWindow" WindowState="Maximized"
        Loaded="Window_Loaded" ShowInTaskbar="False" IsKeyboardFocusedChanged="Window_IsKeyboardFocusedChanged" KeyDown="Window_KeyDown"
        d:DataContext="{d:DesignInstance local:frmShow}"  ContentRendered="Window_OnContentRendered">
    <Window.Resources>
        <Converters:MathOperationConverter x:Key="MathOperationConverter"/>
        <CollectionViewSource x:Key="dsMaritalStatus" d:DesignSource="{d:DesignInstance {x:Type Model:MaritalStatus}, CreateList=True}"/>
        <CollectionViewSource x:Key="dsAgencies" d:DesignSource="{d:DesignInstance {x:Type Model:AgencyShort}, CreateList=True}"/>
        <CollectionViewSource x:Key="dsCountries" d:DesignSource="{d:DesignInstance {x:Type Model:CountryShort}, CreateList=True}"/>
        <CollectionViewSource x:Key="dsLanguajes" d:DesignSource="{d:DesignInstance {x:Type Model:LanguageShort}, CreateList=True}"/>
        <CollectionViewSource x:Key="dsHotels" d:DesignSource="{d:DesignInstance {x:Type Model:Hotel}, CreateList=True}"/>
        <CollectionViewSource x:Key="dsCurrencies" d:DesignSource="{d:DesignInstance {x:Type Model:CurrencyShort}, CreateList=True}"/>
        <CollectionViewSource x:Key="dsPaymentTypes" d:DesignSource="{d:DesignInstance {x:Type Model:PaymentType}, CreateList=True}"/>
        <CollectionViewSource x:Key="dsPersonnel" d:DesignSource="{d:DesignInstance {x:Type Model:PersonnelShort}, CreateList=True}"/>
        <CollectionViewSource x:Key="dsTeamsSalesMen" d:DesignSource="{d:DesignInstance {x:Type Model:TeamSalesmen}, CreateList=True}"/>
        <CollectionViewSource x:Key="dsPersonnelPR" d:DesignSource="{d:DesignInstance {x:Type Model:PersonnelShort}, CreateList=True}"/>
        <CollectionViewSource x:Key="dsPersonnelLiner" d:DesignSource="{d:DesignInstance {x:Type Model:PersonnelShort}, CreateList=True}" />
        <CollectionViewSource x:Key="dsPersonnelCloser" d:DesignSource="{d:DesignInstance {x:Type Model:PersonnelShort}, CreateList=True}" />
        <CollectionViewSource x:Key="dsPersonnelExitCloser" d:DesignSource="{d:DesignInstance {x:Type Model:PersonnelShort}, CreateList=True}" />
        <CollectionViewSource x:Key="dsPersonnelPodium" d:DesignSource="{d:DesignInstance {x:Type Model:PersonnelShort}, CreateList=True}" />
        <CollectionViewSource x:Key="dsPersonnelVlo" d:DesignSource="{d:DesignInstance {x:Type Model:PersonnelShort}, CreateList=True}" />
        <CollectionViewSource x:Key="dsPersonnelHostsEntry" d:DesignSource="{d:DesignInstance {x:Type Model:PersonnelShort}, CreateList=True}" />
        <CollectionViewSource x:Key="dsPersonnelHostsGifts" d:DesignSource="{d:DesignInstance {x:Type Model:PersonnelShort}, CreateList=True}" />
        <CollectionViewSource x:Key="dsPersonnelHostsExit" d:DesignSource="{d:DesignInstance {x:Type Model:PersonnelShort}, CreateList=True}" />
        <CollectionViewSource x:Key="dsCreditCardTypes" d:DesignSource="{d:DesignInstance {x:Type Model:CreditCardType}, CreateList=True}" />
        <CollectionViewSource x:Key="dsGuestStatusTypes" d:DesignSource="{d:DesignInstance {x:Type Model:GuestStatusType}, CreateList=True}" />
        <CollectionViewSource x:Key="dsDisputeStatus" d:DesignSource="{d:DesignInstance {x:Type Model:DisputeStatus}, CreateList=True}" />
        <CollectionViewSource x:Key="dsPaymentPlaces" d:DesignSource="{d:DesignInstance {x:Type Model:PaymentPlace}, CreateList=True}" />
        <CollectionViewSource x:Key="dsGifts" d:DesignSource="{d:DesignInstance {x:Type Model:Gift}, CreateList=True}" />

        <CollectionViewSource x:Key="dsGuestCreditCardList" d:DesignSource="{d:DesignInstance {x:Type Model:GuestCreditCard}, CreateList=True}" Source="{Binding GuestCreditCardList}" />
        <CollectionViewSource x:Key="dsBookingDepositList" d:DesignSource="{d:DesignInstance {x:Type Model:BookingDeposit}, CreateList=True}" Source="{Binding BookingDepositList}" />
        <CollectionViewSource x:Key="dsInvitationGiftList" d:DesignSource="{d:DesignInstance {x:Type Model:InvitationGift}, CreateList=True}" Source="{Binding InvitationGiftList}" />
        <Converters:ByteToBoleanValueConverterHelper x:Key="ByteToBoleanValueC"/>
    </Window.Resources>
    <xctk:BusyIndicator x:Name="busyIndicator">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="30" />
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition />
                <ColumnDefinition />
            </Grid.ColumnDefinitions>

            <!--#region Barra decoracion -->
            <Border Background="#147F79" Height="42" VerticalAlignment="Top" HorizontalAlignment="Stretch" Grid.Row="0" Margin="0,0,0,0" Grid.ColumnSpan="2">
                <Grid HorizontalAlignment="Right" VerticalAlignment="Stretch" Margin="0,0,10,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="24" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="21" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <Viewbox Stretch="Uniform" Height="24" HorizontalAlignment="Stretch" Grid.Column="0" Grid.Row="0">
                        <Image x:Name="image" Source="pack://application:,,,/IM.Styles;component/Images/BUser.png" />
                    </Viewbox>
                    <TextBlock x:Name="txtUserName" VerticalAlignment="Center"
                           Foreground="White" Grid.Column="1" Grid.Row="0" />
                    <TextBlock x:Name="txtPlaces" VerticalAlignment="Center" HorizontalAlignment="Right" Foreground="White" Grid.Row="1" Grid.ColumnSpan="2" />
                </Grid>
            </Border>
            <!--#endregion-->

            <!--#region  TabControl-->
            <Border CornerRadius="5" Padding="5"  VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Grid.Row="1" Margin="10,5,10,5" Grid.ColumnSpan="2">
                <TabControl Style="{StaticResource TabControlStyle}">
                    <TabItem Name="tabGeneral" Style="{StaticResource TabItemStyle}" Header="General">
                        <ScrollViewer VerticalScrollBarVisibility="Auto">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>

                                <!--#region Guest Info  Row 0-->
                                <Border x:Name="brdGuestInfo" CornerRadius="5" BorderThickness="1" BorderBrush="Black" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Grid.Row="0" Padding="2" Margin="0,1">
                                    <StackPanel>
                                        <TextBlock Text="Guest Information" Margin="2,0" Background="#147F79" FontSize="12" Foreground="White" FontWeight="Bold" />
                                        <Viewbox StretchDirection="DownOnly" HorizontalAlignment="Left">
                                            <StackPanel Orientation="Horizontal">
                                                <StackPanel VerticalAlignment="Center" Margin="3,0">
                                                    <TextBlock Text="GUID" TextAlignment="Center" />
                                                    <TextBox Name="txtguID" Width="100" Text="{Binding GuestObj.guID, Mode=TwoWay}" />
                                                </StackPanel>
                                                <StackPanel Name="stkRsrvNum" VerticalAlignment="Center" Margin="3">
                                                    <TextBlock Text="Rsrv. Num." TextAlignment="Center" />
                                                    <TextBox Name="txtguHReservID" Width="100" Text="{Binding GuestObj.guHReservID, Mode=TwoWay}" IsEnabled="False" />
                                                </StackPanel>
                                                <Border x:Name="brdSearchReservation" MouseLeftButtonDown="brdSearchButton_MouseLeftButtonDown" Style="{StaticResource brd-ButtonsBig}"  Width="75" Height="25" Margin="3,0">
                                                    <StackPanel Orientation="Horizontal">
                                                        <Viewbox Stretch="Uniform" Width="20">
                                                            <Image Source="pack://application:,,,/IM.Styles;component/Images/BSearch.png" />
                                                        </Viewbox>
                                                        <TextBlock Text="Search" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="3,0,0,0" />
                                                    </StackPanel>
                                                </Border>
                                                <StackPanel Name="stkOutInvitation" VerticalAlignment="Center">
                                                    <TextBlock Text="Out Invit." TextAlignment="Center" />
                                                    <TextBox Name="txtguOutInvitNum" Width="100" Text="{Binding GuestObj.guOutInvitNum, Mode=TwoWay}" />
                                                </StackPanel>
                                            </StackPanel>
                                        </Viewbox>
                                    </StackPanel>
                                </Border>
                                <!--#endregion-->

                                <!--#region Profile Opera Row 1-->
                                <Border x:Name="brdProfileOpera" CornerRadius="5" BorderThickness="1" BorderBrush="Black" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Grid.Row="1" Padding="2" Margin="0,1">
                                    <StackPanel>
                                        <TextBlock Text="Profile Opera" Margin="2,0" Background="#147F79" FontSize="12" Foreground="White" FontWeight="Bold" />
                                        <Viewbox StretchDirection="DownOnly" HorizontalAlignment="Left">
                                            <StackPanel Name="stkProfileOpera" Orientation="Horizontal">
                                                <StackPanel VerticalAlignment="Center" Margin="3,0">
                                                    <TextBlock Text="ID" TextAlignment="Center" />
                                                    <TextBox Name="txtguIdProfileOpera" Width="100" Text="{Binding GuestObj.guIdProfileOpera, Mode=TwoWay}" MaxLength="15" IsEnabled="False" />
                                                </StackPanel>
                                                <StackPanel VerticalAlignment="Center" Margin="3">
                                                    <TextBlock Text="Last Name" TextAlignment="Center" />
                                                    <TextBox Name="txtguLastNameOriginal" Width="100" Text="{Binding GuestObj.guLastNameOriginal, Mode=TwoWay}" MaxLength="65" IsEnabled="False" />
                                                </StackPanel>
                                                <StackPanel VerticalAlignment="Center">
                                                    <TextBlock Text="First Name" TextAlignment="Center" />
                                                    <TextBox Name="txtguFirstNameOriginal" Width="100" Text="{Binding GuestObj.guFirstNameOriginal, Mode=TwoWay}" MaxLength="40" IsEnabled="False" />
                                                </StackPanel>
                                            </StackPanel>
                                        </Viewbox>
                                    </StackPanel>
                                </Border>
                                <!--#endregion-->

                                <!--#region Show Row 2-->
                                <Border x:Name="brdShow" CornerRadius="5" BorderThickness="1" BorderBrush="Black" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Grid.Row="2" Padding="2" Margin="0,1">
                                    <StackPanel>
                                        <TextBlock Text="Show" Margin="2,0" Background="#147F79" FontSize="12" Foreground="White" FontWeight="Bold" />
                                        <Viewbox StretchDirection="DownOnly" HorizontalAlignment="Left">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition />
                                                    <ColumnDefinition />
                                                    <ColumnDefinition />
                                                </Grid.ColumnDefinitions>
                                                <StackPanel>
                                                    <Grid>
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition />
                                                            <ColumnDefinition />
                                                        </Grid.ColumnDefinitions>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition />
                                                            <RowDefinition />
                                                        </Grid.RowDefinitions>
                                                        <StackPanel x:Name="stkShows" Orientation="Horizontal"  Margin="3,0">
                                                            <CheckBox x:Name="chkguShow" Content="Shows" IsChecked="{Binding GuestObj.guShow, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, NotifyOnValidationError=true, ValidatesOnExceptions=true}" VerticalAlignment="Center" Margin="3"  Checked ="chkguShow_Checked"  Unchecked ="chkguShow_Checked"/>
                                                            <xctk:DateTimePicker x:Name="dtpguShowD" Tag="Show Date" Value="{Binding GuestObj.guShowD, Mode=TwoWay,  UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource dtp-DateRange-TK}" KeyDown="Control_KeyDown" DefaultValue="" DisplayDefaultValueOnEmptyText="False" />
                                                        </StackPanel>
                                                        <StackPanel Orientation="Horizontal" Margin="3,0" Grid.Column="1">
                                                            <TextBlock Text="Book" TextAlignment="Center" VerticalAlignment="Center" Margin="3" />
                                                            <xctk:DateTimePicker x:Name="dtpguBookD" IsEnabled="False" Value="{Binding GuestObj.guBookD, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource dtp-DateRange-TK}" KeyDown="Control_KeyDown" DefaultValue="" DisplayDefaultValueOnEmptyText="False" />
                                                        </StackPanel>
                                                        <StackPanel x:Name="stkPresentedInvitation" Orientation="Horizontal" Margin="3,0" Grid.Row="1">
                                                            <CheckBox x:Name="chkguPresentedInvitation" Tag="if the guest presented invitation" Content="Presented Invitation" HorizontalAlignment="Center" IsChecked="{Binding GuestObj.guPresentedInvitation, Mode=TwoWay}" Margin="3" />
                                                        </StackPanel>
                                                        <StackPanel  Orientation="Horizontal" Margin="3,0" Grid.Row="1" Grid.Column="1">
                                                            <CheckBox x:Name="chkguNotifiedEmailShowNotInvited" Content="Notified" HorizontalAlignment="Center" IsChecked="{Binding GuestObj.guNotifiedEmailShowNotInvited, Mode=TwoWay}" Margin="3" />
                                                        </StackPanel>
                                                    </Grid>
                                                    <Separator Height="7" />
                                                    <Grid>
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition />
                                                            <ColumnDefinition />
                                                            <ColumnDefinition />
                                                        </Grid.ColumnDefinitions>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition />
                                                            <RowDefinition />
                                                            <RowDefinition />
                                                        </Grid.RowDefinitions>
                                                        <StackPanel Orientation="Horizontal"  Margin="3,0">
                                                            <CheckBox x:Name="chkguDirect" Content="Direct" IsChecked="{Binding GuestObj.guDirect, Mode=TwoWay}" VerticalAlignment="Center" Margin="3" />
                                                        </StackPanel>
                                                        <StackPanel Orientation="Horizontal"  Margin="3,0" Grid.Column="1">
                                                            <CheckBox x:Name="chkguQuinella" Content="Quinella" IsChecked="{Binding GuestObj.guQuinella, Mode=TwoWay}" VerticalAlignment="Center" Margin="3" />
                                                        </StackPanel>
                                                        <StackPanel Orientation="Horizontal"  Margin="3,0" Grid.Column="2">
                                                            <CheckBox x:Name="chkguQuinellaSplit" Content="Quinella Split" IsChecked="{Binding GuestObj.guQuinellaSplit, Mode=TwoWay}" VerticalAlignment="Center" Margin="3" Checked="chkguQuinellaSplit_Checked" Unchecked="chkguQuinellaSplit_Checked" />
                                                        </StackPanel>
                                                        <StackPanel  Orientation="Horizontal" Margin="3,0" Grid.Row="1" Grid.ColumnSpan="3">
                                                            <TextBlock  Text="Main Invit." TextAlignment="Center" Margin="3" VerticalAlignment="Center" />
                                                            <TextBox x:Name="txtguMainInvit" Height="23"  AcceptsReturn="False"  Width="53" Text="{Binding GuestObj.guMainInvit, Mode=TwoWay, NotifyOnValidationError=true, ValidatesOnExceptions=true}" Margin="3" IsEnabled="False" />
                                                            <TextBox x:Name="txtMainInvitName" Height="23"  AcceptsReturn="False"  Width="91" Margin="3" IsEnabled="False" />
                                                        </StackPanel>
                                                        <StackPanel Orientation="Horizontal"  Margin="3,0" Grid.Row="2" Grid.ColumnSpan="3">
                                                            <CheckBox x:Name="chkguAntesIO" Content="Before In &amp; Out" IsChecked="{Binding GuestObj.guAntesIO, Mode=TwoWay}" VerticalAlignment="Center" Margin="3" />
                                                        </StackPanel>
                                                    </Grid>
                                                </StackPanel>
                                                <Separator Grid.Column="1" Style="{StaticResource {x:Static ToolBar.SeparatorStyleKey}}" />
                                                <StackPanel HorizontalAlignment="Center" Grid.Column="2">
                                                    <Grid Margin="3,0">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition />
                                                            <ColumnDefinition />
                                                            <ColumnDefinition />
                                                        </Grid.ColumnDefinitions>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition />
                                                            <RowDefinition />
                                                        </Grid.RowDefinitions>
                                                        <RadioButton x:Name="rdbguTour" Content="Tour" IsChecked="{Binding GuestObj.guTour, Mode=TwoWay, NotifyOnValidationError=true, ValidatesOnExceptions=true}" Margin="3" />
                                                        <RadioButton x:Name="rdbguCTour" Content="CT" IsChecked="{Binding GuestObj.guCTour, Mode=TwoWay, NotifyOnValidationError=true, ValidatesOnExceptions=true}" Grid.Row="1" Margin="3" />
                                                        <RadioButton x:Name="rdbguInOut" Content="In &amp; Out" IsChecked="{Binding GuestObj.guInOut, Mode=TwoWay, NotifyOnValidationError=true, ValidatesOnExceptions=true}" Grid.Column="1" Margin="3" />
                                                        <RadioButton x:Name="rdbguSaveProgram" Content="Save" IsChecked="{Binding GuestObj.guSaveProgram, Mode=TwoWay, NotifyOnValidationError=true, ValidatesOnExceptions=true}" Grid.Row="1" Grid.Column="1" Margin="3" />
                                                        <RadioButton x:Name="rdbguWalkOut" Content="Walk Out" IsChecked="{Binding GuestObj.guWalkOut, Mode=TwoWay, NotifyOnValidationError=true, ValidatesOnExceptions=true}" Grid.Column="2" Margin="3" />
                                                        <RadioButton x:Name="rdbguWithQuinella" Content="WQ" IsChecked="{Binding GuestObj.guWithQuinella, Mode=TwoWay, NotifyOnValidationError=true, ValidatesOnExceptions=true}" Grid.Column="2" Grid.Row="1" Margin="3" />
                                                    </Grid>
                                                    <Separator Height="7" />
                                                    <StackPanel Orientation="Horizontal">
                                                        <StackPanel Orientation="Horizontal"  Margin="3,0">
                                                            <TextBlock Text="Time In" Margin="3" VerticalAlignment="Center" />
                                                            <Button x:Name="btnIn" Width="20" Height="15" Background="LightGreen" Margin="3" Click="btnIn_Click" />
                                                            <xctk:TimePicker x:Name="tpkguTimeInT" Style="{StaticResource tpk-Time-TK}" Value="{Binding GuestObj.guTimeInT,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                                        </StackPanel>
                                                        <StackPanel Orientation="Horizontal" Margin="3,0">
                                                            <TextBlock Text="Time Out" Margin="3" VerticalAlignment="Center" />
                                                            <Button x:Name="btnOut" Width="20" Height="15" Background="Red" Margin="3" Click="btnOut_Click" />
                                                            <xctk:TimePicker x:Name="tpkguTimeOutT" Style="{StaticResource tpk-Time-TK}" Value="{Binding GuestObj.guTimeOutT,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                                        </StackPanel>
                                                    </StackPanel>
                                                    <Separator Height="7" />
                                                    <StackPanel x:Name="stkCheckInOut" Orientation="Horizontal">
                                                        <StackPanel Orientation="Horizontal"  Margin="3,0">
                                                            <TextBlock Text="Arrival" Margin="3" VerticalAlignment="Center" />
                                                            <xctk:DateTimePicker x:Name="dtpguCheckInD" Tag="check-in date" Margin="0" Value="{Binding GuestObj.guCheckInD, Mode=TwoWay,  UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource dtp-DateRange-TK}" KeyDown="Control_KeyDown" DefaultValue="" DisplayDefaultValueOnEmptyText="False" />
                                                        </StackPanel>
                                                        <StackPanel Orientation="Horizontal" Margin="3,0">
                                                            <TextBlock Text="Departure" Margin="3" VerticalAlignment="Center" />
                                                            <xctk:DateTimePicker x:Name="dtpguCheckOutD" Tag="check-out date" Margin="0" Value="{Binding GuestObj.guCheckOutD, Mode=TwoWay,  UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource dtp-DateRange-TK}" KeyDown="Control_KeyDown" DefaultValue="" DisplayDefaultValueOnEmptyText="False" />
                                                        </StackPanel>
                                                    </StackPanel>
                                                </StackPanel>
                                            </Grid>
                                        </Viewbox>
                                    </StackPanel>
                                </Border>
                                <!--#endregion Show Row 2-->

                                <!--#region Places Row 3-->
                                <Border x:Name="brdTaxi" CornerRadius="5" BorderThickness="1" BorderBrush="Black" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Grid.Row="3" Padding="2" Margin="0,1">
                                    <StackPanel>
                                        <TextBlock Text="Taxi" Margin="2,0" Background="#147F79" FontSize="12" Foreground="White" FontWeight="Bold" />
                                        <Viewbox StretchDirection="DownOnly" HorizontalAlignment="Left">
                                            <StackPanel Orientation="Horizontal">
                                                <StackPanel VerticalAlignment="Center"  Margin="3,0">
                                                    <TextBlock Text="Taxi In" TextAlignment="Center" />
                                                    <TextBox x:Name="txtguTaxiIn" Height="23"   Width="80" Text="{Binding GuestObj.guTaxiIn, Mode=TwoWay, StringFormat=N2}" HorizontalContentAlignment="Right" />
                                                </StackPanel>
                                                <StackPanel VerticalAlignment="Center" Margin="3,0">
                                                    <TextBlock Text="Taxi In Rcpt." TextAlignment="Center" />
                                                    <TextBox x:Name="txtguTaxiIngr" Height="23" Width="80" Text="{Binding GuestObj.guTaxiIngr, Mode=TwoWay, NotifyOnValidationError=true, ValidatesOnExceptions=true}" HorizontalContentAlignment="Right" IsReadOnly="True" />
                                                </StackPanel>
                                                <Separator Style="{StaticResource {x:Static ToolBar.SeparatorStyleKey}}" />
                                                <StackPanel VerticalAlignment="Center"  Margin="3,0">
                                                    <TextBlock Text="Taxi Out" TextAlignment="Center" />
                                                    <TextBox x:Name="txtguTaxiOut" Height="23" Width="80" Text="{Binding GuestObj.guTaxiOut, Mode=TwoWay, StringFormat=N2, NotifyOnValidationError=true, ValidatesOnExceptions=true}" HorizontalContentAlignment="Right" />
                                                </StackPanel>
                                                <StackPanel VerticalAlignment="Center"  Margin="3,0">
                                                    <TextBlock Text="Taxi Out Rcpt." TextAlignment="Center" />
                                                    <TextBox x:Name="txtguTaxiOutgr" Height="23" Width="80" Text="{Binding GuestObj.guTaxiOutgr, Mode=TwoWay, StringFormat=N2, NotifyOnValidationError=true, ValidatesOnExceptions=true}" HorizontalContentAlignment="Right" IsReadOnly="True" />
                                                </StackPanel>
                                            </StackPanel>
                                        </Viewbox>
                                    </StackPanel>
                                </Border>
                                <!--#endregion -->

                                <!--#region Places Row 4-->
                                <Border x:Name="brdPlaces" CornerRadius="5" BorderThickness="1" BorderBrush="Black" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Grid.Row="4" Padding="2" Margin="0,1">
                                    <StackPanel>
                                        <TextBlock Text="Places" Margin="2,0" Background="#147F79" FontSize="12" Foreground="White" FontWeight="Bold" />
                                        <Viewbox StretchDirection="DownOnly" HorizontalAlignment="Left">
                                            <StackPanel Orientation="Horizontal">
                                                <StackPanel VerticalAlignment="Center"  Margin="3,0">
                                                    <TextBlock Text="Lead Source" TextAlignment="Center" />
                                                    <TextBox Name="txtguls" Width="100" Text="{Binding GuestObj.guls, Mode=TwoWay}" IsReadOnly="True" />
                                                </StackPanel>
                                                <StackPanel VerticalAlignment="Center" Margin="3,0">
                                                    <TextBlock Text="Location" TextAlignment="Center" />
                                                    <TextBox x:Name="txtguloInvit" Tag="location" Width="100" Text="{Binding GuestObj.guloInvit, Mode=TwoWay, NotifyOnValidationError=true, ValidatesOnExceptions=true}" />
                                                </StackPanel>
                                                <StackPanel VerticalAlignment="Center"  Margin="3,0">
                                                    <TextBlock Text="Sales Room" TextAlignment="Center" />
                                                    <TextBox x:Name="txtgusr" Width="100" Text="{Binding GuestObj.gusr, Mode=TwoWay, NotifyOnValidationError=true, ValidatesOnExceptions=true}" IsReadOnly="True" />
                                                </StackPanel>
                                            </StackPanel>
                                        </Viewbox>
                                    </StackPanel>
                                </Border>
                                <!--#endregion-->

                                <!--#region Guest1 Row 5-->
                                <Border x:Name="brdGuest1" CornerRadius="5" BorderThickness="1" BorderBrush="Black" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Grid.Row="5" Padding="2" Margin="0,1">
                                    <StackPanel>
                                        <TextBlock Text="Guest 1" Margin="2,0" Background="#147F79" FontSize="12" Foreground="White" FontWeight="Bold" />
                                        <Viewbox StretchDirection="DownOnly" HorizontalAlignment="Left">
                                            <StackPanel Name="stkGuest1" Orientation="Horizontal">
                                                <StackPanel VerticalAlignment="Center" Margin="3,0">
                                                    <TextBlock Text="Last Name" TextAlignment="Center" />
                                                    <TextBox Name="txtguLastName1" Tag="guest last name" Width="100" Text="{Binding GuestObj.guLastName1, Mode=TwoWay}" MaxLength="65" />
                                                </StackPanel>
                                                <StackPanel VerticalAlignment="Center">
                                                    <TextBlock Text="First Name" TextAlignment="Center" />
                                                    <TextBox Name="txtguFirstName1" Tag="guest first name" Width="100" Text="{Binding GuestObj.guFirstName1, Mode=TwoWay}" MaxLength="40" />
                                                </StackPanel>
                                                <StackPanel VerticalAlignment="Center" Margin="3,0">
                                                    <TextBlock Text="Age" TextAlignment="Center" />
                                                    <TextBox Name="txtguAge1" Width="50" Text="{Binding GuestObj.guAge1, Mode=TwoWay}" />
                                                </StackPanel>
                                                <StackPanel VerticalAlignment="Center">
                                                    <TextBlock Text="Marital Status" TextAlignment="Center" />
                                                    <ComboBox Name="cmbgums1" Tag="guest 1 marital status" Width="100" TextSearch.TextPath="msID"
                                                          ItemsSource="{Binding Source={StaticResource dsMaritalStatus}}"  Style="{StaticResource cbx-General}"
                                                          ItemTemplate="{StaticResource cbx-MaritalStatus-Concat}"
                                                          ToolTip="{Binding Path=SelectedItem.(Model:MaritalStatus.msN), RelativeSource={RelativeSource Self}}"
                                                          SelectedValuePath="msID" IsSynchronizedWithCurrentItem="False"
                                                          SelectedValue="{Binding GuestObj.gums1,Mode=TwoWay}" />
                                                </StackPanel>
                                                <StackPanel VerticalAlignment="Center">
                                                    <TextBlock Text="Ocupation" TextAlignment="Center" />
                                                    <TextBox Name="txtguOccup1" Width="100" Text="{Binding GuestObj.guOccup1, Mode=TwoWay}" />
                                                </StackPanel>
                                                <StackPanel VerticalAlignment="Center">
                                                    <TextBlock Text="Email" TextAlignment="Center" />
                                                    <TextBox Name="txtguEmail1" Width="100" Text="{Binding GuestObj.guEmail1, Mode=TwoWay}" />
                                                </StackPanel>
                                            </StackPanel>
                                        </Viewbox>
                                    </StackPanel>
                                </Border>
                                <!--#endregion-->

                                <!--#region Guest2 Row 6-->
                                <Border x:Name="brdGuest2" CornerRadius="5" BorderThickness="1" BorderBrush="Black" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Grid.Row="6" Padding="2" Margin="0,1">
                                    <StackPanel>
                                        <TextBlock Text="Guest 2" Margin="2,0" Background="#147F79" FontSize="12" Foreground="White" FontWeight="Bold" />
                                        <Viewbox StretchDirection="DownOnly" HorizontalAlignment="Left">
                                            <StackPanel Name="stkGuest2" Orientation="Horizontal">
                                                <StackPanel VerticalAlignment="Center" Margin="3,0">
                                                    <TextBlock Text="Last Name" TextAlignment="Center" />
                                                    <TextBox Name="txtguLastName2" Width="100" Text="{Binding GuestObj.guLastname2, Mode=TwoWay}" />
                                                </StackPanel>
                                                <StackPanel VerticalAlignment="Center">
                                                    <TextBlock Text="First Name" TextAlignment="Center" />
                                                    <TextBox Name="txtguFirstName2" Width="100" Text="{Binding GuestObj.guFirstName2, Mode=TwoWay}" />
                                                </StackPanel>
                                                <StackPanel VerticalAlignment="Center" Margin="3,0">
                                                    <TextBlock Text="Age" TextAlignment="Center" />
                                                    <TextBox Name="txtguAge2" Width="50" Text="{Binding GuestObj.guAge2, Mode=TwoWay}" />
                                                </StackPanel>
                                                <StackPanel VerticalAlignment="Center">
                                                    <TextBlock Text="Marital Status" TextAlignment="Center" />
                                                    <ComboBox Name="cmbgums2" Tag="guest 2 marital status" Width="100" TextSearch.TextPath="msID"
                                                          ItemsSource="{Binding Source={StaticResource dsMaritalStatus}}" Style="{StaticResource cbx-General}"
                                                          ItemTemplate="{StaticResource cbx-MaritalStatus-Concat}"
                                                          ToolTip="{Binding Path=SelectedItem.(Model:MaritalStatus.msN), RelativeSource={RelativeSource Self}}"
                                                          SelectedValuePath="msID" IsSynchronizedWithCurrentItem="False"
                                                          SelectedValue="{Binding GuestObj.gums2, Mode=TwoWay}" />
                                                </StackPanel>
                                                <StackPanel VerticalAlignment="Center">
                                                    <TextBlock Text="Ocupation" TextAlignment="Center" />
                                                    <TextBox Name="txtguOccup2" Width="100" Text="{Binding GuestObj.guOccup2, Mode=TwoWay}" />
                                                </StackPanel>
                                                <StackPanel VerticalAlignment="Center">
                                                    <TextBlock Text="Email" TextAlignment="Center" />
                                                    <TextBox Name="txtguEmail2" Width="100" Text="{Binding GuestObj.guEmail2, Mode=TwoWay}" />
                                                </StackPanel>
                                            </StackPanel>
                                        </Viewbox>
                                    </StackPanel>
                                </Border>
                                <!--#endregion-->

                                <!--#region Additional Guest Row 7-->
                                <Border x:Name="brdAdditionalGuest" CornerRadius="5" BorderThickness="1" BorderBrush="Black" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Grid.Row="7" Padding="2" Margin="0,1">
                                    <StackPanel>
                                        <TextBlock Text="Additional Guest" Background="#147F79" FontSize="12" Foreground="White" FontWeight="Bold" />
                                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                            <Button x:Name="btnSearchGuestAdditional" HorizontalAlignment="Left" Margin="5" VerticalAlignment="Center" Width="80" Click="btnSearchGuestAdditional_Click">
                                                <StackPanel Orientation="Horizontal">
                                                    <Image Source="pack://application:,,,/IM.Styles;component/Images/Search.ico" Width="15" Height="15" HorizontalAlignment="Left" />
                                                    <TextBlock Text="Search" HorizontalAlignment="Right" />
                                                </StackPanel>
                                            </Button>
                                            <Button x:Name="btnAddGuestAdditional" HorizontalAlignment="Left" Margin="5" VerticalAlignment="Center" Width="80" Click="BtnAddGuestAdditional_OnClick">
                                                <StackPanel Orientation="Horizontal">
                                                    <Image Source="pack://application:,,,/IM.Styles;component/Images/Add.png" Width="15" Height="15" HorizontalAlignment="Left" />
                                                    <TextBlock Text="Add" HorizontalAlignment="Right" />
                                                </StackPanel>
                                            </Button>
                                        </StackPanel>
                                        <Viewbox StretchDirection="DownOnly" HorizontalAlignment="Left">
                                            <StackPanel>
                                                <DataGrid  Name="dtgGuestAdditional"
                                                           CanUserAddRows="True" CanUserSortColumns="False"
                                                           Height="80" SelectionMode="Single"
                                                           SelectionUnit="FullRow"
                                                           ItemsSource="{Binding GuestAdditionalList, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                           EnableRowVirtualization="True"
                                                           IsSynchronizedWithCurrentItem="True"
                                                           AutoGenerateColumns="False" CanUserReorderColumns="False"
                                                           RowValidationErrorTemplate="{x:Null}"
                                                           BeginningEdit="dtgGuestAdditional_BeginningEdit"
                                                           PreparingCellForEdit="dtgGuestAdditional_PreparingCellForEdit"
                                                           CellEditEnding="dtgGuestAdditional_CellEditEnding"
                                                           RowEditEnding="dtgGuestAdditional_RowEditEnding">

                                                    <DataGrid.Columns>
                                                        <DataGridTextColumn Header="GUID" ElementStyle="{StaticResource txt-ErrorInfo}" Binding="{Binding guID, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}" styClasses:FormatInputPropertyClass.FormatInput="Number" />
                                                        <DataGridTextColumn Header="Last Name" Binding="{Binding guLastName1, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" IsReadOnly="True" />
                                                        <DataGridTextColumn Header="First Name" Binding="{Binding guFirstName1, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" IsReadOnly="True" />
                                                        <DataGridTemplateColumn Width="55" IsReadOnly="True">
                                                            <DataGridTemplateColumn.CellTemplate>
                                                                <DataTemplate>
                                                                    <Image Name="imgDetails" Source="pack://application:,,,/IM.Styles;component/Images/Details.ico"  Height="15" MouseLeftButtonDown="guestDetails_Click" />
                                                                </DataTemplate>
                                                            </DataGridTemplateColumn.CellTemplate>
                                                        </DataGridTemplateColumn>
                                                    </DataGrid.Columns>
                                                </DataGrid>
                                            </StackPanel>
                                        </Viewbox>
                                    </StackPanel>
                                </Border>
                                <!--#endregion-->
                            </Grid>
                        </ScrollViewer>
                    </TabItem>
                    <TabItem Name="tabOtherInfoGiftsCreditCardsGuestStatus" Header="Other Info, Gifts, Credit Cards, Status &amp; Comments" Style="{StaticResource TabItemStyle}">
                        <ScrollViewer VerticalScrollBarVisibility="Auto">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <!--#region OtherInformation  Row 0-->
                                <Border x:Name="brdOtherInfo" CornerRadius="5" BorderThickness="1" BorderBrush="Black" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Grid.Row="0"  Padding="2" Margin="0,1">
                                    <StackPanel>
                                        <TextBlock Text="Other Information" Margin="2,0" Background="#147F79" FontSize="12" Foreground="White" FontWeight="Bold" />
                                        <Viewbox StretchDirection="DownOnly" HorizontalAlignment="Left">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto" />
                                                    <ColumnDefinition Width="Auto" />
                                                    <ColumnDefinition Width="Auto" />
                                                    <ColumnDefinition Width="Auto" />
                                                </Grid.ColumnDefinitions>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition  Height="Auto" />
                                                    <RowDefinition  Height="*" />
                                                    <RowDefinition  Height="*" />
                                                </Grid.RowDefinitions>



                                                <StackPanel Grid.ColumnSpan="4">
                                                    <StackPanel Orientation="Horizontal">
                                                        <StackPanel VerticalAlignment="Center" Margin="3,0">
                                                            <TextBlock Text="Member #" TextAlignment="Center" />
                                                            <TextBox Name="txtguMembershipNum" Width="200" Text="{Binding GuestObj.guMembershipNum, Mode=TwoWay}" />
                                                        </StackPanel>
                                                        <StackPanel VerticalAlignment="Center" Margin="3,0">
                                                            <TextBlock Text="C. Code" TextAlignment="Center" />
                                                            <TextBox Name="txtguO1" Width="80" Text="{Binding GuestObj.guO1, Mode=TwoWay}" IsReadOnly="True" />
                                                        </StackPanel>
                                                        <StackPanel VerticalAlignment="Center" Margin="3,0">
                                                            <TextBlock Text="Children" TextAlignment="Center" />
                                                            <TextBox Name="txtguChildren" Width="30" Text="{Binding GuestObj.guChildren, Mode=TwoWay}" HorizontalContentAlignment="Right" />
                                                        </StackPanel>
                                                        <StackPanel VerticalAlignment="Center" Margin="3,0">
                                                            <TextBlock Text="Age(s)" TextAlignment="Center" />
                                                            <TextBox Name="txtguChildrenAges" Width="80" Text="{Binding GuestObj.guChildrenAges, Mode=TwoWay}" />
                                                        </StackPanel>
                                                        <StackPanel VerticalAlignment="Center" Margin="3,0">
                                                            <TextBlock Text="City" TextAlignment="Center" />
                                                            <TextBox x:Name="txtguCity" Width="228" Text="{Binding GuestObj.guCity, Mode=TwoWay}" />
                                                        </StackPanel>
                                                        <StackPanel VerticalAlignment="Center" Margin="3,0">
                                                            <TextBlock Text="State" TextAlignment="Center" />
                                                            <TextBox x:Name="txtguState" Width="228" Text="{Binding GuestObj.guState, Mode=TwoWay}" />
                                                        </StackPanel>
                                                    </StackPanel>
                                                    <Separator Height="7" />
                                                    <StackPanel Orientation="Horizontal">
                                                        <StackPanel VerticalAlignment="Center" Margin="3,0">
                                                            <CheckBox x:Name="chkguFamily" Content="Family" IsChecked="{Binding GuestObj.guFamily, Mode=TwoWay, NotifyOnValidationError=true, ValidatesOnExceptions=true}" />
                                                        </StackPanel>
                                                        <StackPanel VerticalAlignment="Center" Margin="3,0">
                                                            <CheckBox x:Name="chkguIdentification" Content="Identification" IsChecked="{Binding GuestObj.guIdentification, Mode=TwoWay, NotifyOnValidationError=true, ValidatesOnExceptions=true}" />
                                                        </StackPanel>
                                                        <StackPanel VerticalAlignment="Center" Margin="3,0">
                                                            <CheckBox x:Name="chkguInterval" Content="Interval" IsChecked="{Binding GuestObj.guInterval, Mode=TwoWay, NotifyOnValidationError=true, ValidatesOnExceptions=true}" IsEnabled="False" />
                                                        </StackPanel>
                                                        <StackPanel Orientation="Horizontal" Margin="3,0">
                                                            <TextBlock Text="Books" VerticalAlignment="Center" />
                                                            <TextBox x:Name="txtguRoomsQty" Height="23"  Width="26" Text="{Binding GuestObj.guRoomsQty, Mode=TwoWay, NotifyOnValidationError=true, ValidatesOnExceptions=true}" MaxLength="1" />
                                                        </StackPanel>
                                                        <StackPanel Orientation="Horizontal" Margin="3,0">
                                                            <TextBlock Text="Shows" VerticalAlignment="Center" />
                                                            <TextBox x:Name="txtguShowsQty" Height="23" AcceptsReturn="False" Width="26" Text="{Binding GuestObj.guShowsQty, Mode=TwoWay, NotifyOnValidationError=true, ValidatesOnExceptions=true}" MaxLength="1" />
                                                        </StackPanel>
                                                        <StackPanel Orientation="Horizontal" Margin="3,0">
                                                            <TextBlock Text="Pax" VerticalAlignment="Center" />
                                                            <TextBox Name="txtguPax" Width="50" Text="{Binding GuestObj.guPax, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                                        </StackPanel>
                                                    </StackPanel>
                                                </StackPanel>
                                                <StackPanel HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Grid.Row="1" Grid.Column="0" Margin="0,5,10,10">
                                                    <TextBlock Text="Hotel" Background="#147F79" FontSize="12" Foreground="White" FontWeight="Bold" />
                                                    <StackPanel Orientation="Horizontal">
                                                        <StackPanel HorizontalAlignment="Left">
                                                            <TextBlock Text="Room #" Margin="0,5" />
                                                            <TextBox Name="txtguRoomNum" Tag="room number" Width="50" Text="{Binding GuestObj.guRoomNum, Mode=TwoWay}" />
                                                        </StackPanel>
                                                        <StackPanel HorizontalAlignment="Left" Margin="5,0,0,0">
                                                            <TextBlock Text="{Binding ElementName=cmbOtherInfoHotel, Path=SelectedItem.(Model:Hotel.hoID), StringFormat='Hotel ID: {0}'}" Margin="0,5" />
                                                            <ComboBox Name="cmbguHotel" Tag="hotel" Width="200" TextSearch.TextPath="hoID"
                                                                  ItemsSource="{Binding Source={StaticResource dsHotels}}" Style="{StaticResource cbx-General}"
                                                                  ItemTemplate="{StaticResource cbx-Hotel-img}"
                                                                  ToolTip="{Binding Path=SelectedItem.(Model:Hotel.hoID), RelativeSource={RelativeSource Self}}"
                                                                  SelectedValuePath="hoID" IsSynchronizedWithCurrentItem="False"
                                                                  SelectedValue="{Binding GuestObj.guHotel, Mode=TwoWay}" />
                                                        </StackPanel>
                                                    </StackPanel>
                                                </StackPanel>
                                                <StackPanel HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Grid.Row="1" Grid.Column="1" Margin="0,5,10,10">
                                                    <TextBlock Text="Agency" Background="#147F79" FontSize="12" Foreground="White" FontWeight="Bold" />
                                                    <StackPanel Orientation="Horizontal">
                                                        <StackPanel HorizontalAlignment="Left">
                                                            <TextBlock Text="{Binding ElementName=cmbOtherInfoAgency, Path=SelectedItem.(Model:AgencyShort.agID), StringFormat='Agency ID: {0}'}" Margin="0,5" />
                                                            <ComboBox Name="cmbguag" Tag="agency" Width="200" TextSearch.TextPath="agID"
                                                                  ItemsSource="{Binding Source={StaticResource dsAgencies}}" Style="{StaticResource cbx-General}"
                                                                  ItemTemplate="{StaticResource cbx-Agency-img}"
                                                                  ToolTip="{Binding Path=SelectedItem.(Model:AgencyShort.agN), RelativeSource={RelativeSource Self}}"
                                                                  SelectedValuePath="agID" IsSynchronizedWithCurrentItem="False"
                                                                  SelectedValue="{Binding GuestObj.guag, Mode=TwoWay}" />
                                                        </StackPanel>
                                                    </StackPanel>
                                                </StackPanel>
                                                <StackPanel HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Grid.Row="1" Grid.Column="2" Margin="0,5,10,10">
                                                    <TextBlock Text="Country" Background="#147F79" FontSize="12" Foreground="White" FontWeight="Bold" />
                                                    <StackPanel Orientation="Horizontal">
                                                        <StackPanel HorizontalAlignment="Left">
                                                            <TextBlock Text="{Binding ElementName=cmbOtherInfoCountry, Path=SelectedItem.(Model:CountryShort.coID), StringFormat='Country ID: {0}'}" Margin="0,5" />
                                                            <ComboBox Name="cmbguco" Tag="country" Width="200" TextSearch.TextPath="coN"
                                                                  ItemsSource="{Binding Source={StaticResource dsCountries}}" Style="{StaticResource cbx-General}"
                                                                  ItemTemplate="{StaticResource cbx-Country-img}"
                                                                  ToolTip="{Binding Path=SelectedItem.(Model:CountryShort.coN), RelativeSource={RelativeSource Self}}"
                                                                  SelectedValuePath="coID" IsSynchronizedWithCurrentItem="False"
                                                                  SelectedValue="{Binding GuestObj.guco, Mode=TwoWay}" />
                                                        </StackPanel>
                                                    </StackPanel>
                                                </StackPanel>
                                                <StackPanel HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Grid.Row="1" Grid.Column="3" Margin="0,5,10,10">
                                                    <TextBlock Text="Languaje" Background="#147F79" FontSize="12" Foreground="White" FontWeight="Bold" />
                                                    <StackPanel Orientation="Horizontal">
                                                        <StackPanel HorizontalAlignment="Left">
                                                            <TextBlock Text="{Binding ElementName=cmbLanguage, Path=SelectedItem.(Model:LanguageShort.laID), StringFormat='Language ID: {0}'}" Margin="0,5" />

                                                            <ComboBox Name="cmbLanguage" Width="200" TextSearch.TextPath="laN"
                                                                  ItemsSource="{Binding Source={StaticResource dsLanguajes}}" Style="{StaticResource cbx-General}"
                                                                  ItemTemplate="{StaticResource cbx-Languages-Concat}"
                                                                  ToolTip="{Binding Path=SelectedItem.(Model:LanguageShort.laN), RelativeSource={RelativeSource Self}}"
                                                                  SelectedValuePath="laID" IsSynchronizedWithCurrentItem="False"
                                                                  SelectedValue="{Binding GuestObj.gula, Mode=TwoWay}" />
                                                        </StackPanel>
                                                    </StackPanel>
                                                </StackPanel>
                                            </Grid>
                                        </Viewbox>
                                    </StackPanel>
                                </Border>
                                <!--#endregion-->
                                <!--#region Gifts Row 1-->
                                <Border x:Name="brdGifts" CornerRadius="5" BorderThickness="1" BorderBrush="Black" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Grid.Row="1" Padding="2" Margin="0,1">
                                    <StackPanel>
                                        <TextBlock Text="Gifts" Margin="2,0" Background="#147F79" FontSize="12" Foreground="White" FontWeight="Bold" />
                                        <Viewbox StretchDirection="DownOnly" HorizontalAlignment="Left">
                                            <StackPanel>
                                                <DataGrid Name="dtgGifts" BeginningEdit="dtgGifts_BeginningEdit" MaxHeight="80" Height="80" ItemsSource="{Binding Source={StaticResource dsInvitationGiftList}}"
                                                      EnableRowVirtualization="True"
                                                      IsSynchronizedWithCurrentItem="True"
                                                      AutoGenerateColumns="False" CanUserAddRows="True" CanUserReorderColumns="False"
                                                      CanUserSortColumns="False" SelectionMode="Single" RowValidationErrorTemplate="{x:Null}"
                                                      PreparingCellForEdit="dtgGifts_PreparingCellForEdit"
                                                      CellEditEnding="dtgGifts_CellEditEnding"
                                                      RowEditEnding="dtgGifts_RowEditEnding">
                                                    <DataGrid.Columns>
                                                        <DataGridTextColumn Header="Qty"
                                                                        styClasses:MaxLengthPropertyClass.MaxLength="2"
                                                                        ElementStyle="{StaticResource txt-ErrorInfo}"
                                                                        Binding="{Binding igQty, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                                        </DataGridTextColumn>

                                                        <DataGridComboBoxColumn x:Name="cmbGiftsInvitationGift" Header="Gift" Width="200"
                                                                            SelectedValueBinding="{Binding iggi, Mode=TwoWay, ValidatesOnExceptions=True, UpdateSourceTrigger=PropertyChanged}"
                                                                            DisplayMemberPath="giN" SelectedValuePath="giID"
                                                                            ItemsSource="{Binding Source={StaticResource dsGifts}}" />

                                                        <DataGridTextColumn Header="Adults" x:Name="dgTextAdult"
                                                                        styClasses:MaxLengthPropertyClass.MaxLength="4"
                                                                        Binding="{Binding igAdults, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                                        </DataGridTextColumn>

                                                        <DataGridTextColumn Header="Minors"
                                                                        styClasses:MaxLengthPropertyClass.MaxLength="2"
                                                                         ElementStyle="{StaticResource txt-ErrorInfo}"
                                                                        Binding="{Binding igMinors, Mode=TwoWay, ValidatesOnDataErrors=True, UpdateSourceTrigger =PropertyChanged}">
                                                        </DataGridTextColumn>

                                                        <DataGridTextColumn Header="E.Adults" Binding="{Binding igExtraAdults, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                                        <DataGridTextColumn Header="Charge To" Binding="{Binding igct, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                                        <DataGridTextColumn Header="Receipt" IsReadOnly="True"  Binding="{Binding iggr, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                                        <DataGridTextColumn Header="Folios" IsReadOnly="True" Binding="{Binding igFolios, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                                        <DataGridTextColumn Header="Comments" Binding="{Binding igComments, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                                    </DataGrid.Columns>
                                                </DataGrid>
                                                <StackPanel Orientation="Horizontal" Margin="0,5">
                                                    <StackPanel VerticalAlignment="Center">
                                                        <TextBlock Text="Max Auth" TextAlignment="Center" />
                                                        <TextBox Name="txtGiftMaxAuth" Width="100" IsReadOnly="True" />
                                                    </StackPanel>
                                                    <StackPanel VerticalAlignment="Center" Margin="5,0">
                                                        <TextBlock Text="Total Cost" TextAlignment="Center" />
                                                        <TextBox Name="txtGiftTotalCost" Width="100" IsReadOnly="True" />
                                                    </StackPanel>
                                                    <StackPanel VerticalAlignment="Center">
                                                        <TextBlock Text="Total Price" TextAlignment="Center" />
                                                        <TextBox Name="txtGiftTotalPrice" Width="100" IsReadOnly="True" />
                                                    </StackPanel>
                                                </StackPanel>
                                            </StackPanel>
                                        </Viewbox>
                                    </StackPanel>
                                </Border>
                                <!--#endregion-->
                                <!--#region Credit Card Row 2-->
                                <Border x:Name="brdCreditCards" CornerRadius="5" BorderThickness="1" BorderBrush="Black" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Grid.Row="2" Padding="2" Margin="0,1">
                                    <StackPanel>
                                        <TextBlock Text="Credit Card" Margin="2,0" Background="#147F79" FontSize="12" Foreground="White" FontWeight="Bold" />
                                        <Viewbox StretchDirection="DownOnly" HorizontalAlignment="Left">
                                            <StackPanel>
                                                <StackPanel Name="stkCcCompany">
                                                    <TextBlock Text="CC Company"/>
                                                    <TextBox Name="txtguCCType" IsEnabled="False" Text="{Binding GuestObj.guCCType, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                                </StackPanel>
                                                <DataGrid Name="dtgCCCompany"  Margin="0,0,0,10" MaxHeight="80" Height="80" ItemsSource="{Binding GuestCreditCardList}"
                                                       AutoGenerateColumns="False" CanUserAddRows="True" CanUserReorderColumns="False"    LostKeyboardFocus="dtgCCCompany_LostKeyboardFocus"            
                                                                            RowEditEnding="dtgCCCompany_RowEditEnding" >
                                                    <DataGrid.Columns>
                                                        <DataGridTextColumn Header="Qty" x:Name="gdQuantity" Binding="{Binding gdQuantity, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, ValidatesOnExceptions=False}" Width="40" styClasses:MaxLengthPropertyClass.MaxLength="1"/>
                                                        <DataGridComboBoxColumn x:Name="cmbCurrencyCCCompany" Header="Credit Card" Width="250"
                                                                            SelectedValueBinding="{Binding gdcc, Mode=TwoWay, ValidatesOnExceptions=True, UpdateSourceTrigger=PropertyChanged}"
                                                                            DisplayMemberPath="ccN"                                                                                
                                                                            SelectedValuePath="ccID"                                                                           
                                                                            ItemsSource="{Binding Source={StaticResource  dsCreditCardTypes}}" >
                                                            <DataGridComboBoxColumn.EditingElementStyle>
                                                                <Style TargetType="ComboBox">
                                                                    <EventSetter Event="SelectionChanged" Handler="SelectionChangedCurrencyCcCompanyColumn"/>
                                                                    <EventSetter Event="Loaded" Handler="LoadedCurrencyCcCompanyColumn"/>
                                                                </Style>
                                                            </DataGridComboBoxColumn.EditingElementStyle>
                                                        </DataGridComboBoxColumn>
                                                        <DataGridTextColumn Header="gdgu" Binding="{Binding gdgu, Mode=TwoWay, ValidatesOnExceptions=True, UpdateSourceTrigger=PropertyChanged}" Visibility="Hidden"/>
                                                    </DataGrid.Columns>
                                                </DataGrid>
                                            </StackPanel>
                                        </Viewbox>
                                    </StackPanel>
                                </Border>
                                <!--#endregion-->



                                <!--#region Guest Status Row 3-->
                                <Border x:Name="brdGuestStatus" CornerRadius="5" BorderThickness="1" BorderBrush="Black"  Grid.Row="3" Padding="2" Margin="0,1">
                                    <StackPanel>
                                        <TextBlock Text="Guest Status" Background="#147F79" FontSize="12" Foreground="White" FontWeight="Bold" />
                                        <Viewbox StretchDirection="DownOnly" HorizontalAlignment="Left">
                                            <StackPanel Orientation="Horizontal">
                                                <StackPanel HorizontalAlignment="Left">
                                                    <TextBlock Text="{Binding ElementName=cmbGuestStatus, Path=SelectedItem.(Model:GuestStatusType.gsID), StringFormat='Guest Status ID: {0}'}" Margin="0,5" />
                                                    <ComboBox Name="cmbGuestStatus" Width="250"  TextSearch.TextPath="gsN"
                                                          ItemsSource="{Binding Source={StaticResource dsGuestStatusTypes}}" Style="{StaticResource cbx-General}"
                                                          ItemTemplate="{StaticResource cbx-GuestStatusType-Concat}"
                                                          ToolTip="{Binding Path=SelectedItem.(Model:GuestStatusType.gsN), RelativeSource={RelativeSource Self}}"
                                                          SelectedValuePath="gsID"
                                                          SelectedValue="{Binding GuestObj.guGStatus, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" SelectionChanged="cmbGuestStatus_SelectionChanged" Tag="Guest Status"/>
                                                </StackPanel>
                                            </StackPanel>
                                        </Viewbox>
                                    </StackPanel>
                                </Border>
                                <!--#endregion-->
                                <!--#region Comments Row 4-->
                                <Border x:Name="brdComments" CornerRadius="5" BorderThickness="1" BorderBrush="Black" Grid.Row="4" Padding="2" Margin="0,1">
                                    <StackPanel>
                                        <TextBlock Text="Comments" Background="#147F79" FontSize="12" Foreground="White" FontWeight="Bold" />
                                        <Viewbox StretchDirection="DownOnly" HorizontalAlignment="Left">
                                            <Grid HorizontalAlignment="Left">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition />
                                                    <ColumnDefinition />
                                                </Grid.ColumnDefinitions>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition />
                                                    <RowDefinition />
                                                    <RowDefinition />
                                                </Grid.RowDefinitions>
                                                <TextBlock Text="PR Comments" Margin="3" VerticalAlignment="Center" HorizontalAlignment="Right" />
                                                <TextBox x:Name="txtguExtraInfo" Height="23" AcceptsReturn="False" Width="435" Text="{Binding GuestObj.guExtraInfo, Mode=TwoWay, NotifyOnValidationError=true, ValidatesOnExceptions=true}" Margin="3" Grid.Column="1" />
                                                <TextBlock  Text="Hostess Comments" Margin="3" VerticalAlignment="Center" HorizontalAlignment="Right" Grid.Row="1" />
                                                <TextBox x:Name="txtguWComments" Height="23"  AcceptsReturn="False"  Width="435" Text="{Binding GuestObj.guWComments, Mode=TwoWay, NotifyOnValidationError=true, ValidatesOnExceptions=true}" Margin="3" Grid.Row="1" Grid.Column="1" />
                                                <TextBlock Text="Exit Hostess Comments" Margin="3" VerticalAlignment="Center" HorizontalAlignment="Right" Grid.Row="2" />
                                                <TextBox x:Name="txtguEComments" Height="23" AcceptsReturn="False" Width="435" Text="{Binding GuestObj.guEComments, Mode=TwoWay, NotifyOnValidationError=true, ValidatesOnExceptions=true}" Margin="3" Grid.Row="2" Grid.Column="1" />
                                            </Grid>
                                        </Viewbox>
                                    </StackPanel>
                                </Border>
                                <!--#endregion-->
                            </Grid>
                        </ScrollViewer>
                    </TabItem>
                    <TabItem Name="tabDepositsSalesmen"  Header="Deposits &amp; Salesmen" Style="{StaticResource TabItemStyle}">
                        <ScrollViewer VerticalScrollBarVisibility="Auto">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <!--#region Deposits Row 0-->
                                <Border x:Name="brdDeposits" CornerRadius="5" BorderThickness="1" BorderBrush="Black" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Grid.Row="0" Padding="2" Margin="0,1">
                                    <StackPanel>
                                        <TextBlock Text="Deposits" Background="#147F79" FontSize="12" Foreground="White" FontWeight="Bold" />
                                        <Viewbox StretchDirection="DownOnly" HorizontalAlignment="Left">
                                            <StackPanel>
                                                <DataGrid Name="dtgDeposits" Margin="0,0,0,10" MaxHeight="80" BeginningEdit="dtgDeposits_BeginningEdit" CellEditEnding="dtgDeposits_CellEditEnding" RowEditEnding="dtgDeposits_RowEditEnding" PreparingCellForEdit="dtgDeposits_PreparingCellForEdit" Height="80" ItemsSource="{Binding Source={StaticResource dsBookingDepositList}}"
                                                       AutoGenerateColumns="False" CanUserAddRows="True" CanUserReorderColumns="False">
                                                    <DataGrid.Columns>
                                                        <DataGridTextColumn Header="ID" Binding="{Binding bdID,UpdateSourceTrigger=PropertyChanged}" IsReadOnly="True" />
                                                        <DataGridTextColumn Header="Date" Binding="{Binding bdD,UpdateSourceTrigger=PropertyChanged,StringFormat='{}{0:dd/MM/yyyy}'}" IsReadOnly="True" />
                                                        <DataGridTextColumn Header="Deposits" Width="70" Binding="{Binding bdAmount,UpdateSourceTrigger=PropertyChanged,StringFormat={}{n:2}}"/>
                                                        <DataGridTextColumn Header="Received" Width="70" Binding="{Binding bdReceived,UpdateSourceTrigger=PropertyChanged,StringFormat={}{n:2}}"/>
                                                        <DataGridTextColumn Header="CxC" Width="70" IsReadOnly="True">
                                                            <DataGridTextColumn.ElementStyle>
                                                                <Style TargetType="TextBlock">
                                                                    <Setter Property="Text" >
                                                                        <Setter.Value>
                                                                            <MultiBinding Converter="{StaticResource ResourceKey=MathOperationConverter}" ConverterParameter="REST">
                                                                                <Binding Path="bdAmount"/>
                                                                                <Binding Path="bdReceived"/>
                                                                            </MultiBinding>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </Style>
                                                            </DataGridTextColumn.ElementStyle>
                                                        </DataGridTextColumn>
                                                        <DataGridComboBoxColumn x:Name="cmbCurrencyDeposits" Header="Currency" Width="90"
                                                                            SelectedValueBinding="{Binding bdcu,UpdateSourceTrigger=PropertyChanged}"
                                                                            DisplayMemberPath="cuN"
                                                                            SelectedValuePath="cuID"
                                                                            ItemsSource="{Binding Source={StaticResource dsCurrencies}}" />
                                                        <DataGridComboBoxColumn x:Name="cmbPaymentTypeDeposits"  Header="Payment Type" Width="90"
                                                                            SelectedValueBinding="{Binding bdpt,UpdateSourceTrigger=PropertyChanged}"
                                                                            DisplayMemberPath="ptN"
                                                                            SelectedValuePath="ptID"
                                                                            ItemsSource="{Binding Source={StaticResource dsPaymentTypes}}" />
                                                        <DataGridComboBoxColumn x:Name="cmbDisputeStatusDeposits" Header="Dispute Status" Width="90"
                                                                            SelectedValueBinding="{Binding bdds,UpdateSourceTrigger=PropertyChanged}"
                                                                            DisplayMemberPath="dsN"
                                                                            SelectedValuePath="dsID"
                                                                            ItemsSource="{Binding Source={StaticResource dsDisputeStatus}}" />
                                                        <DataGridComboBoxColumn x:Name="cmbPaymentPlaceDeposits" Header="Payment Place" Width="90"
                                                                            SelectedValueBinding="{Binding bdpc,UpdateSourceTrigger=PropertyChanged}"
                                                                            DisplayMemberPath="pcN"
                                                                            SelectedValuePath="pcID"
                                                                            ItemsSource="{Binding Source={StaticResource dsPaymentPlaces}}" />
                                                        <DataGridComboBoxColumn x:Name="cmbCreditCardTypesDeposits" Header="Credit Card" Width="90"
                                                                            SelectedValueBinding="{Binding bdcc,UpdateSourceTrigger=PropertyChanged}"
                                                                            DisplayMemberPath="ccN"
                                                                            SelectedValuePath="ccID"
                                                                            ItemsSource="{Binding Source={StaticResource dsCreditCardTypes}}" />
                                                        <DataGridTextColumn Header="Card Number" Binding="{Binding bdCardNum, UpdateSourceTrigger=PropertyChanged}" />
                                                        <DataGridTextColumn Header="Expiration" Binding="{Binding bdExpD,UpdateSourceTrigger=PropertyChanged}"/>
                                                        <DataGridTextColumn Header="Authorizathion ID" Binding="{Binding bdAuth,UpdateSourceTrigger=PropertyChanged}" />
                                                        <DataGridTextColumn Header="Folio CxC" Binding="{Binding bdFolioCXC,UpdateSourceTrigger=PropertyChanged}"/>
                                                        <DataGridTextColumn Header="User CxC" Binding="{Binding bdUserCXC,UpdateSourceTrigger=PropertyChanged}" IsReadOnly="True" />
                                                        <DataGridTextColumn Header="Entry CxC" Binding="{Binding bdEntryDCXC, StringFormat={}{0:dd/MM/yyyy},UpdateSourceTrigger=PropertyChanged}" IsReadOnly="True"/>
                                                    </DataGrid.Columns>
                                                </DataGrid>
                                                <StackPanel Orientation="Horizontal">
                                                    <StackPanel>
                                                        <TextBlock Text="Burned" TextAlignment="Center" Margin="0,5" />
                                                        <TextBox Name="txtBurned" Width="120" Text="{Binding GuestObj.guDepositTwisted, Mode=TwoWay, StringFormat={}{0:N2}}" HorizontalContentAlignment="Right" />
                                                    </StackPanel>
                                                    <StackPanel VerticalAlignment="Center" Margin="5,0,0,0">
                                                        <TextBlock Text="Currency" TextAlignment="Center" Margin="0,5" />
                                                        <ComboBox Name="cmbCurrency" Width="200" TextSearch.TextPath="cuN"
                                                              ItemsSource="{Binding Source={StaticResource dsCurrencies}}" Style="{StaticResource cbx-General}"
                                                              ItemTemplate="{StaticResource cbx-Currency-Concat}"
                                                              ToolTip="{Binding Path=SelectedItem.(Model:Currency.cuN), RelativeSource={RelativeSource Self}}"
                                                              SelectedValuePath="cuID" IsSynchronizedWithCurrentItem="False"
                                                              SelectedValue="{Binding GuestObj.gucu, Mode=TwoWay}" />
                                                    </StackPanel>
                                                    <StackPanel VerticalAlignment="Center" Margin="5,0,0,0">
                                                        <TextBlock Text="Payment Type" TextAlignment="Center" Margin="0,5" />
                                                        <ComboBox Name="cmbPaymentType" Width="200"  TextSearch.TextPath="ptN"
                                                              ItemsSource="{Binding Source={StaticResource dsPaymentTypes}}" Style="{StaticResource cbx-General}"
                                                              ItemTemplate="{StaticResource cbx-PaymentType-Concat}"
                                                              ToolTip="{Binding Path=SelectedItem.(Model:PaymentTypeShort.ptN), RelativeSource={RelativeSource Self}}"
                                                              SelectedValuePath="ptID" IsSynchronizedWithCurrentItem="False"
                                                              SelectedValue="{Binding GuestObj.gupt, Mode=TwoWay}" />
                                                    </StackPanel>
                                                    <StackPanel VerticalAlignment="Center" Margin="5,0,0,0">
                                                        <TextBlock Text="Resorts" TextAlignment="Center" Margin="0,5" />
                                                        <ComboBox Name="cmbResorts" Width="200"  TextSearch.TextPath="hoID"
                                                              ItemsSource="{Binding Source={StaticResource dsHotels}}" Style="{StaticResource cbx-General}"
                                                              ItemTemplate="{StaticResource cbx-Hotel-img}"
                                                              ToolTip="{Binding Path=SelectedItem.(Model:Hotel.hoID), RelativeSource={RelativeSource Self}}"
                                                              SelectedValuePath="hoID" IsSynchronizedWithCurrentItem="False"
                                                              SelectedValue="{Binding GuestObj.guHotelB, Mode=TwoWay}" />
                                                    </StackPanel>
                                                    <StackPanel>
                                                        <TextBlock Text="Rcpt" TextAlignment="Center" Margin="0,5" />
                                                        <TextBox Name="txtguDepositgr" Width="120" Text="{Binding GuestObj.guDepositgr, Mode=TwoWay}" HorizontalContentAlignment="Right" IsReadOnly="True" />
                                                    </StackPanel>
                                                </StackPanel>
                                            </StackPanel>
                                        </Viewbox>
                                    </StackPanel>
                                </Border>
                                <!--#endregion-->
                                <!--#region DepositSale Row 1-->
                                <Border x:Name="brdDepositSale" CornerRadius="5" BorderThickness="1" BorderBrush="Black" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Grid.Row="1" Padding="2" Margin="0,1">
                                    <StackPanel>
                                        <TextBlock Text="Deposit Sale" Background="#147F79" FontSize="12" Foreground="White" FontWeight="Bold" />
                                        <Viewbox StretchDirection="DownOnly" HorizontalAlignment="Left">
                                            <StackPanel Orientation="Horizontal">
                                                <StackPanel VerticalAlignment="Center" Margin="3,0">
                                                    <TextBlock Text="Date" TextAlignment="Center" />
                                                    <xctk:DateTimePicker x:Name="dtpguDepositSaleD" Value="{Binding GuestObj.guDepositSaleD, Mode=TwoWay,  UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource dtp-DateRange-TK}" KeyDown="Control_KeyDown" DefaultValue="" DisplayDefaultValueOnEmptyText="False" />
                                                </StackPanel>
                                                <StackPanel VerticalAlignment="Center" Margin="3,0">
                                                    <TextBlock Text="Consecutive" TextAlignment="Center" />
                                                    <TextBox Name="txtguDepositSaleNum" Width="85" Text="{Binding GuestObj.guDepositSaleNum, Mode=TwoWay}" />
                                                </StackPanel>
                                                <StackPanel VerticalAlignment="Center" Margin="3,0">
                                                    <TextBlock Text="Amount" TextAlignment="Center" />
                                                    <TextBox Name="txtguDepSale" Width="71" Text="{Binding GuestObj.guDepSale, Mode=TwoWay, StringFormat=N2, UpdateSourceTrigger=PropertyChanged}" HorizontalContentAlignment="Right" />
                                                </StackPanel>
                                            </StackPanel>
                                        </Viewbox>
                                    </StackPanel>
                                </Border>
                                <!--#endregion-->
                                <Border x:Name="brdSalesmen"  CornerRadius="5" BorderThickness="1" BorderBrush="Black" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Grid.Row="2" Padding="2" Margin="0,1">
                                    <StackPanel>
                                        <TextBlock Text="Salesmen" Margin="2,0" Background="#147F79" FontSize="12" Foreground="White" FontWeight="Bold" />
                                        <Viewbox StretchDirection="DownOnly" HorizontalAlignment="Left">
                                            <StackPanel>
                                                <StackPanel Orientation="Horizontal">
                                                    <StackPanel  VerticalAlignment="Center" Margin="5">
                                                        <TextBlock Text="SELF GEN" TextAlignment="Center" />
                                                        <CheckBox Name="chkguSelfGen" HorizontalAlignment="Center" IsChecked="{Binding GuestObj.guSelfGen, Mode=TwoWay}" Checked="chkguSelfGen_Checked" Unchecked="chkguSelfGen_Checked" />
                                                    </StackPanel>
                                                    <StackPanel  VerticalAlignment="Center" Margin="5">
                                                        <TextBlock Text="Overflow" TextAlignment="Center" />
                                                        <CheckBox Name="chkguOverflow" HorizontalAlignment="Center" IsChecked="{Binding GuestObj.guOverflow, Mode=TwoWay}" />
                                                    </StackPanel>
                                                    <StackPanel x:Name="stkTeam"  VerticalAlignment="Center" Margin="5">
                                                        <TextBlock Text="Team" TextAlignment="Center" />
                                                        <ComboBox Name="cmbguts" Width="120"  TextSearch.TextPath="tsID"
                                                                  ItemsSource="{Binding Source={StaticResource dsTeamsSalesMen}}" Style="{StaticResource cbx-General}"
                                                                  ToolTip="{Binding Path=SelectedItem.(Model:TeamSalesmen.tsN), RelativeSource={RelativeSource Self}}"
                                                                  SelectedValuePath="tsID" IsSynchronizedWithCurrentItem="False" DisplayMemberPath="tsN"
                                                                  SelectedValue="{Binding GuestObj.guts, Mode=TwoWay}" IsEnabled="False" />
                                                    </StackPanel>
                                                    <StackPanel x:Name="stkPR1"  VerticalAlignment="Center" Margin="5">
                                                        <TextBlock Text="PR 1" TextAlignment="Center" />
                                                        <ComboBox x:Name="cmbguPRInvit1" Width="200" TextSearch.TextPath="peID" SelectionChanged="cmb_SelectionChanged" KeyDown="Control_KeyDown"
                                                                  ItemsSource="{Binding Source={StaticResource dsPersonnelPR}}" Style="{StaticResource cbx-General}" ItemTemplate="{StaticResource cbx-Personnel-img}"
                                                                   ToolTip="{Binding Path=SelectedItem.(Model:PersonnelShort.peN), RelativeSource={RelativeSource Self}}"
                                                                  SelectedValuePath="peID" IsSynchronizedWithCurrentItem="False"
                                                                  SelectedValue="{Binding GuestObj.guPRInvit1, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                                    </StackPanel>
                                                    <StackPanel  VerticalAlignment="Center" Margin="5">
                                                        <TextBlock Text="PR 2" TextAlignment="Center" />
                                                        <ComboBox x:Name="cmbguPRInvit2" Width="200" TextSearch.TextPath="peID" SelectionChanged="cmb_SelectionChanged" KeyDown="Control_KeyDown"
                                                                  ItemsSource="{Binding Source={StaticResource dsPersonnelPR}}" Style="{StaticResource cbx-General}" ItemTemplate="{StaticResource cbx-Personnel-img}"
                                                                   ToolTip="{Binding Path=SelectedItem.(Model:PersonnelShort.peN), RelativeSource={RelativeSource Self}}"
                                                                  SelectedValuePath="peID" IsSynchronizedWithCurrentItem="False"
                                                                  SelectedValue="{Binding GuestObj.guPRInvit2, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                                    </StackPanel>
                                                    <StackPanel  VerticalAlignment="Center" Margin="5">
                                                        <TextBlock Text="PR 3" TextAlignment="Center" />
                                                        <ComboBox x:Name="cmbguPRInvit3" Width="200" TextSearch.TextPath="peID" SelectionChanged="cmb_SelectionChanged" KeyDown="Control_KeyDown"
                                                                  ItemsSource="{Binding Source={StaticResource dsPersonnelPR}}" Style="{StaticResource cbx-General}" ItemTemplate="{StaticResource cbx-Personnel-img}"
                                                                   ToolTip="{Binding Path=SelectedItem.(Model:PersonnelShort.peN), RelativeSource={RelativeSource Self}}"
                                                                  SelectedValuePath="peID" IsSynchronizedWithCurrentItem="False"
                                                                  SelectedValue="{Binding GuestObj.guPRInvit3, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                                    </StackPanel>
                                                </StackPanel>
                                                <Separator Height="7" />
                                                <StackPanel Orientation="Horizontal">
                                                    <Border Style="{StaticResource brd-Catalogs}">
                                                        <StackPanel Orientation="Horizontal">
                                                            <StackPanel Orientation="Horizontal">
                                                                <RadioButton x:Name="rdbguLiner1Type" GroupName="LinertType"  Content="Liner" Margin="5" VerticalAlignment="Center"
                                                                         IsChecked="{Binding GuestObj.guLiner1Type, Mode=TwoWay, Converter={StaticResource ByteToBoleanValueC}, UpdateSourceTrigger=PropertyChanged, ConverterParameter= 0}" />
                                                                <RadioButton x:Name="rdbguLiner2Type" GroupName="LinertType"  Content="Front to Middle" Margin="5" VerticalAlignment="Center"
                                                                         IsChecked="{Binding GuestObj.guLiner1Type, Mode=TwoWay, Converter={StaticResource ByteToBoleanValueC}, UpdateSourceTrigger=PropertyChanged, ConverterParameter= 1}" />
                                                                <RadioButton x:Name="rdbguLiner3Type" GroupName="LinertType"  Content="Front to Back"  Margin="5" VerticalAlignment="Center"
                                                                         IsChecked="{Binding GuestObj.guLiner1Type, Mode=TwoWay, Converter={StaticResource ByteToBoleanValueC}, UpdateSourceTrigger=PropertyChanged, ConverterParameter= 2}" />
                                                            </StackPanel>
                                                            <StackPanel Margin="5,0,0,0">
                                                                <TextBlock Text="Liner 1"  TextAlignment="Center" Margin="3" />
                                                                <ComboBox x:Name="cmbguLiner1" Width="200" TextSearch.TextPath="peID" SelectionChanged="cmb_SelectionChanged" KeyDown="Control_KeyDown"
                                                                  ItemsSource="{Binding Source={StaticResource dsPersonnelLiner}}" Style="{StaticResource cbx-General}" ItemTemplate="{StaticResource cbx-Personnel-img}"
                                                                   ToolTip="{Binding Path=SelectedItem.(Model:PersonnelShort.peN), RelativeSource={RelativeSource Self}}"
                                                                  SelectedValuePath="peID" IsSynchronizedWithCurrentItem="False"
                                                                  SelectedValue="{Binding GuestObj.guLiner1, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                                            </StackPanel>
                                                        </StackPanel>
                                                    </Border>
                                                    <StackPanel  Margin="5,0,0,0">
                                                        <TextBlock Text="Liner 2" TextAlignment="Center" Margin="3" />
                                                        <ComboBox x:Name="cmbguLiner2" Width="200" TextSearch.TextPath="peID" SelectionChanged="cmb_SelectionChanged" KeyDown="Control_KeyDown"
                                                                  ItemsSource="{Binding Source={StaticResource dsPersonnelLiner}}" Style="{StaticResource cbx-General}" ItemTemplate="{StaticResource cbx-Personnel-img}"
                                                                   ToolTip="{Binding Path=SelectedItem.(Model:PersonnelShort.peN), RelativeSource={RelativeSource Self}}"
                                                                  SelectedValuePath="peID" IsSynchronizedWithCurrentItem="False"
                                                                  SelectedValue="{Binding GuestObj.guLiner2, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                                    </StackPanel>
                                                </StackPanel>
                                                <Separator Height="7" />
                                                <StackPanel Orientation="Horizontal">
                                                    <StackPanel VerticalAlignment="Center" Margin="5,0,0,0">
                                                        <TextBlock Text="Closer 1" TextAlignment="Center" Margin="3" />
                                                        <ComboBox x:Name="cmbguCloser1" Width="200" TextSearch.TextPath="peID" SelectionChanged="cmb_SelectionChanged" KeyDown="Control_KeyDown"
                                                                  ItemsSource="{Binding Source={StaticResource dsPersonnelCloser}}" Style="{StaticResource cbx-General}" ItemTemplate="{StaticResource cbx-Personnel-img}"
                                                                   ToolTip="{Binding Path=SelectedItem.(Model:PersonnelShort.peN), RelativeSource={RelativeSource Self}}"
                                                                  SelectedValuePath="peID" IsSynchronizedWithCurrentItem="False"
                                                                  SelectedValue="{Binding GuestObj.guCloser1, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                                    </StackPanel>
                                                    <StackPanel VerticalAlignment="Center" Margin="5,0,0,0">
                                                        <TextBlock Text="Closer 2" TextAlignment="Center" Margin="3" />
                                                        <ComboBox x:Name="cmbguCloser2" Width="200" TextSearch.TextPath="peID" SelectionChanged="cmb_SelectionChanged" KeyDown="Control_KeyDown"
                                                                  ItemsSource="{Binding Source={StaticResource dsPersonnelCloser}}" Style="{StaticResource cbx-General}" ItemTemplate="{StaticResource cbx-Personnel-img}"
                                                                   ToolTip="{Binding Path=SelectedItem.(Model:PersonnelShort.peN), RelativeSource={RelativeSource Self}}"
                                                                  SelectedValuePath="peID" IsSynchronizedWithCurrentItem="False"
                                                                  SelectedValue="{Binding GuestObj.guCloser2, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                                    </StackPanel>
                                                    <StackPanel VerticalAlignment="Center" Margin="5,0,0,0">
                                                        <TextBlock Text="Closer 3" TextAlignment="Center" Margin="3" />
                                                        <ComboBox x:Name="cmbguCloser3" Width="200" TextSearch.TextPath="peID" SelectionChanged="cmb_SelectionChanged" KeyDown="Control_KeyDown"
                                                                  ItemsSource="{Binding Source={StaticResource dsPersonnelCloser}}" Style="{StaticResource cbx-General}" ItemTemplate="{StaticResource cbx-Personnel-img}"
                                                                   ToolTip="{Binding Path=SelectedItem.(Model:PersonnelShort.peN), RelativeSource={RelativeSource Self}}"
                                                                  SelectedValuePath="peID" IsSynchronizedWithCurrentItem="False"
                                                                  SelectedValue="{Binding GuestObj.guCloser3, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                                    </StackPanel>
                                                </StackPanel>
                                                <Separator Height="7" />
                                                <StackPanel Orientation="Horizontal">
                                                    <StackPanel VerticalAlignment="Center" Margin="5,0,0,0">
                                                        <TextBlock Text="Exit 1" TextAlignment="Center" Margin="3" />
                                                        <ComboBox x:Name="cmbguExit1" Width="200" TextSearch.TextPath="peID" SelectionChanged="cmb_SelectionChanged" KeyDown="Control_KeyDown"
                                                                  ItemsSource="{Binding Source={StaticResource dsPersonnelExitCloser}}" Style="{StaticResource cbx-General}" ItemTemplate="{StaticResource cbx-Personnel-img}"
                                                                   ToolTip="{Binding Path=SelectedItem.(Model:PersonnelShort.peN), RelativeSource={RelativeSource Self}}"
                                                                  SelectedValuePath="peID" IsSynchronizedWithCurrentItem="False"
                                                                  SelectedValue="{Binding GuestObj.guExit1, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                                    </StackPanel>
                                                    <StackPanel VerticalAlignment="Center" Margin="5,0,0,0">
                                                        <TextBlock Text="Exit 2" TextAlignment="Center" Margin="3" />
                                                        <ComboBox x:Name="cmbguExit2" Width="200" TextSearch.TextPath="peID" SelectionChanged="cmb_SelectionChanged" KeyDown="Control_KeyDown"
                                                                  ItemsSource="{Binding Source={StaticResource dsPersonnelExitCloser}}" Style="{StaticResource cbx-General}" ItemTemplate="{StaticResource cbx-Personnel-img}"
                                                                   ToolTip="{Binding Path=SelectedItem.(Model:PersonnelShort.peN), RelativeSource={RelativeSource Self}}"
                                                                  SelectedValuePath="peID" IsSynchronizedWithCurrentItem="False"
                                                                  SelectedValue="{Binding GuestObj.guExit2, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                                    </StackPanel>
                                                    <StackPanel VerticalAlignment="Center" Margin="5,0,0,0">
                                                        <TextBlock Text="Podium" TextAlignment="Center" Margin="3" />
                                                        <ComboBox x:Name="cmbguPodium" Width="200" TextSearch.TextPath="peID" SelectionChanged="cmb_SelectionChanged" KeyDown="Control_KeyDown"
                                                                  ItemsSource="{Binding Source={StaticResource dsPersonnelPodium}}" Style="{StaticResource cbx-General}" ItemTemplate="{StaticResource cbx-Personnel-img}"
                                                                   ToolTip="{Binding Path=SelectedItem.(Model:PersonnelShort.peN), RelativeSource={RelativeSource Self}}"
                                                                  SelectedValuePath="peID" IsSynchronizedWithCurrentItem="False"
                                                                  SelectedValue="{Binding GuestObj.guPodium, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                                    </StackPanel>
                                                    <StackPanel VerticalAlignment="Center" Margin="5,0,0,0" Visibility="Collapsed">
                                                        <TextBlock Text="VLO" TextAlignment="Center" Margin="3" />
                                                        <ComboBox x:Name="cmbguVLO" Width="200" TextSearch.TextPath="peID" SelectionChanged="cmb_SelectionChanged" KeyDown="Control_KeyDown"
                                                                  ItemsSource="{Binding Source={StaticResource dsPersonnelVlo}}" Style="{StaticResource cbx-General}" ItemTemplate="{StaticResource cbx-Personnel-img}"
                                                                   ToolTip="{Binding Path=SelectedItem.(Model:PersonnelShort.peN), RelativeSource={RelativeSource Self}}"
                                                                  SelectedValuePath="peID" IsSynchronizedWithCurrentItem="False"
                                                                  SelectedValue="{Binding GuestObj.guVLO, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                                    </StackPanel>
                                                </StackPanel>
                                                <Separator Height="7" />
                                                <StackPanel Orientation="Horizontal">

                                                    <StackPanel VerticalAlignment="Center" Margin="5,0,0,0">
                                                        <TextBlock Text="Hostess" TextAlignment="Center" Margin="3" />
                                                        <ComboBox x:Name="cmbguEntryHost" Width="200" TextSearch.TextPath="peID" SelectionChanged="cmb_SelectionChanged" KeyDown="Control_KeyDown"
                                                                  ItemsSource="{Binding Source={StaticResource dsPersonnelHostsEntry}}" Style="{StaticResource cbx-General}" ItemTemplate="{StaticResource cbx-Personnel-img}"
                                                                   ToolTip="{Binding Path=SelectedItem.(Model:PersonnelShort.peN), RelativeSource={RelativeSource Self}}"
                                                                  SelectedValuePath="peID" IsSynchronizedWithCurrentItem="False"
                                                                  SelectedValue="{Binding GuestObj.guEntryHost, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                                    </StackPanel>
                                                    <StackPanel VerticalAlignment="Center" Margin="5,0,0,0">
                                                        <TextBlock Text="Gifts Hostess" TextAlignment="Center" Margin="3" />
                                                        <ComboBox x:Name="cmbguGiftsHost" Width="200" TextSearch.TextPath="peID" SelectionChanged="cmb_SelectionChanged" KeyDown="Control_KeyDown"
                                                                  ItemsSource="{Binding Source={StaticResource dsPersonnelHostsGifts}}" Style="{StaticResource cbx-General}" ItemTemplate="{StaticResource cbx-Personnel-img}"
                                                                   ToolTip="{Binding Path=SelectedItem.(Model:PersonnelShort.peN), RelativeSource={RelativeSource Self}}"
                                                                  SelectedValuePath="peID" IsSynchronizedWithCurrentItem="False"
                                                                  SelectedValue="{Binding GuestObj.guGiftsHost, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                                    </StackPanel>
                                                    <StackPanel VerticalAlignment="Center" Margin="5,0,0,0">
                                                        <TextBlock Text="Exit Hostess" TextAlignment="Center" Margin="3" />
                                                        <ComboBox x:Name="cmbguExitHost" Width="200" TextSearch.TextPath="peID" SelectionChanged="cmb_SelectionChanged" KeyDown="Control_KeyDown"
                                                                  ItemsSource="{Binding Source={StaticResource dsPersonnelHostsExit}}" Style="{StaticResource cbx-General}" ItemTemplate="{StaticResource cbx-Personnel-img}"
                                                                   ToolTip="{Binding Path=SelectedItem.(Model:PersonnelShort.peN), RelativeSource={RelativeSource Self}}"
                                                                  SelectedValuePath="peID" IsSynchronizedWithCurrentItem="False"
                                                                  SelectedValue="{Binding GuestObj.guExitHost, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                                    </StackPanel>
                                                </StackPanel>
                                                <Separator Height="7" />
                                                <StackPanel Orientation="Horizontal"  HorizontalAlignment="Center">
                                                    <Button x:Name="btnShowsSalesmen" Content="Salesmen"  Width="100" Click="btnShowsSalesmen_Click" Template="{Binding Source={StaticResource ButtonTemplate}}" />
                                                </StackPanel>
                                            </StackPanel>
                                        </Viewbox>
                                    </StackPanel>
                                </Border>
                            </Grid>
                        </ScrollViewer>
                    </TabItem>
                </TabControl>
            </Border>
            <!--#endregion-->

            <!--#region Barra Logs-->
            <Border CornerRadius="5" BorderThickness="1" BorderBrush="Black"  Grid.Row="2" Margin="10,5,10,0" HorizontalAlignment="Center">
                <StackPanel HorizontalAlignment="Left">
                    <TextBlock Text="Changed By" Margin="10,0,0,0" />
                    <StackPanel Orientation="Horizontal" Margin="3">
                        <TextBox x:Name="txtChangedBy" Height="23" AcceptsReturn="False" Width="100" />
                        <PasswordBox x:Name="txtPwd" Width="100" Height="23" />
                        <Border x:Name="imgButtonLog" Style="{StaticResource brd-ButtonsBig}" MouseLeftButtonDown="imgButtonLog_OnMouseLeftButtonDown">
                            <StackPanel Orientation="Horizontal">
                                <Viewbox Stretch="Uniform" Width="20">
                                    <Image Source="pack://application:,,,/IM.Styles;component/Images/BLog.png" />
                                </Viewbox>
                                <TextBlock Text="Log" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="3,0,0,0" />
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </StackPanel>
            </Border>
            <!--#endregion-->

            <!--#region Barra de Menu Opciones-->
            <Border x:Name="brdBtn" CornerRadius="5" BorderThickness="1" BorderBrush="Black"  Grid.Row="2" Grid.Column="1" Margin="10,5,10,0" HorizontalAlignment="Center">
                <StackPanel Orientation="Horizontal" Height="40" Margin="3">
                    <TextBox x:Name="txtocWelcomeCopies"  Height="23"  VerticalAlignment="Center" Width="35" Text="{Binding OcWelcomeCopies, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, TargetNullValue=1}" MaxLength="1" TextAlignment="Center" PreviewTextInput="txtocWelcomeCopies_PreviewTextInput" LostFocus="TxtocWelcomeCopies_OnLostFocus" />
                    <Border x:Name="imgButtonPrint" Style="{StaticResource brd-ButtonsBig}" MouseLeftButtonDown="imgButtonPrint_MouseLeftButtonDown">
                        <StackPanel Orientation="Horizontal">
                            <Viewbox Stretch="Uniform" Width="20">
                                <Image Source="pack://application:,,,/IM.Styles;component/Images/BPrinter.png" />
                            </Viewbox>
                            <TextBlock Text="Print" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="3,0,0,0" />
                        </StackPanel>
                    </Border>
                    <Border x:Name="imgButtonSave" Style="{StaticResource brd-ButtonsBig}" MouseLeftButtonDown="imgButtonSave_MouseLeftButtonDown">
                        <StackPanel Orientation="Horizontal">
                            <Viewbox Stretch="Uniform" Width="20">
                                <Image Source="pack://application:,,,/IM.Styles;component/Images/BSave.png" />
                            </Viewbox>
                            <TextBlock Text="Save" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="3,0,0,0" />
                        </StackPanel>
                    </Border>
                    <Border x:Name="imgButtonCancel" Style="{StaticResource brd-ButtonsBig}" MouseLeftButtonDown="imgButtonCancel_OnMouseLeftButtonDown">
                        <StackPanel Orientation="Horizontal">
                            <Viewbox Stretch="Uniform" Width="20">
                                <Image Source="pack://application:,,,/IM.Styles;component/Images/BCancel.png" />
                            </Viewbox>
                            <TextBlock Text="Cancel" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="3,0,0,0" />
                        </StackPanel>
                    </Border>
                </StackPanel>
            </Border>
            <!--#endregion-->

            <!--#region  Estatus Bar-->
            <StatusBar x:Name="stbStatusBar" HorizontalAlignment="Stretch" VerticalAlignment="Bottom" Grid.Row="3" Margin="10,0,10,0" Grid.ColumnSpan="2">
                <StatusBarItem x:Name="statusBarCap" Content="CAP"  HorizontalContentAlignment="Stretch" />
                <StatusBarItem x:Name="statusBarNum" Content="NUM"  HorizontalContentAlignment="Stretch" />
                <StatusBarItem x:Name="statusBarIns" Content="INS"  HorizontalContentAlignment="Stretch" />
                <Separator />
                <StatusBarItem x:Name="statusBarMessage" HorizontalContentAlignment="Center"  Margin="10,0,0,0">
                    <StackPanel Orientation="Horizontal">
                        <Image x:Name="imgStatusBarMessage" Source="pack://application:,,,/IM.Styles;component/Images/Notice.png"  Height="12" Visibility="Hidden" />
                        <Label x:Name="lblStatusBarMessage" Margin="5,0,0,0" />
                    </StackPanel>
                </StatusBarItem>
                <StatusBarItem x:Name="statusBarReg" Content="0/0" Width="50" HorizontalContentAlignment="Center" HorizontalAlignment="Right" />
            </StatusBar>
            <!--#endregion-->
        </Grid>
    </xctk:BusyIndicator>
</Window>